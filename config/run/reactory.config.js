module.exports = {
  apps: [{
    name: 'ReactoryApi',
    script: 'server.js',
    kill_timeout: 3000,
    listen_timeout: 10000,
    max_memory_restart: '2G',
    interpreter: 'babel-node',
    node_args: '--preset=es2016,stage-2',
    watch: true,
    env: {
      NODE_ENV: 'development',
      APP_DATA_ROOT: '/mnt/d/data/reactory',
      LEGACY_APP_DATA_ROOT: '/mnt/d/data',
      MONGOOSE: 'mongodb://localhost:27017/reactory',
      API_PORT: 4000,
      SENDGRID_API_KEY: process.env.SENDGRID_API_KEY,
      API_URI_ROOT: 'http://locahost:4000/',
      CDN_ROOT: 'http://localhost:4000/cdn/',
      MODE: 'DEVELOP',
      LOG_LEVEL: 'info',
    },
    env_production: {
      NODE_ENV: 'production',
      APP_DATA_ROOT: '/data/reactory',
      LEGACY_APP_DATA_ROOT: '/data/legacy',
      MONGOOSE: 'mongodb://localhost:27017/reactory',
      API_PORT: 4000,
      SENDGRID_API_KEY: process.env.SENDGRID_API_KEY,
      API_URI_ROOT: 'https://api.reactory.net/',
      CDN_ROOT: 'https://api.reactory.net/cdn/',
      MODE: 'PRODUCTION',
      LOG_LEVEL: 'info',
    },
  }],
  deploy: {
    production: {
      user: 'root',
      host: ['api.reactory.net'],
      ref: 'origin/develop',
      repo: 'git@bitbucket.org:WernerWeber/assessor-api.git',
      path: '/var/reactory/api',
      ssh_options: ['IdentityFile=~/.ssh/reactory_bitbucket_key', 'StrictHostKeyChecking=no'],
      'post-deploy': 'pm2 start config/run/reactory.config.js',
      env: {
        NODE_ENV: 'production',
      },
    },
  },
};
