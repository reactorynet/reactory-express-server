"""
  OTelMetricType - OpenTelemetry metric type
"""
enum OTelMetricType {
  GAUGE
  COUNTER
  HISTOGRAM
  SUMMARY
  UPDOWNCOUNTER
}

"""
  HistogramBucket - Histogram bucket data
"""
type HistogramBucket {
  upperBound: Float!
  count: Int!
  exemplars: [Any]
}

"""
  HistogramData - Histogram distribution data
"""
type HistogramData {
  count: Int!
  sum: Float!
  min: Float
  max: Float
  buckets: [HistogramBucket!]!
}

"""
  SummaryQuantile - Summary quantile data
"""
type SummaryQuantile {
  quantile: Float!
  value: Float!
}

"""
  SummaryData - Summary statistics data
"""
type SummaryData {
  count: Int!
  sum: Float!
  quantiles: [SummaryQuantile!]!
}

"""
  TraceContext - Distributed tracing context
"""
type TraceContext {
  traceId: String
  spanId: String
  traceFlags: Int
}

"""
  MetricResource - Resource attributes identifying the metric source
"""
type MetricResource {
  serviceName: String
  serviceVersion: String
  serviceInstanceId: String
  deploymentEnvironment: String
  hostName: String
  attributes: Any
}

"""
  InstrumentationScope - Instrumentation library information
"""
type InstrumentationScope {
  name: String!
  version: String
  schemaUrl: String
}

"""
  Statistic - OpenTelemetry-compatible metric/statistic
  Follows OpenTelemetry Metrics API specification and is compatible with
  Prometheus and Jaeger exporters.
  
  @param id - Unique identifier for the metric
  @param name - Metric name (snake_case, e.g., http_requests_total)
  @param description - Human-readable description of the metric
  @param unit - Unit of measurement (e.g., ms, bytes, requests)
  @param type - Metric type (counter, gauge, histogram, summary, updowncounter)
  @param value - Current metric value (for counter/gauge/updowncounter)
  @param histogramData - Histogram distribution data (when type is HISTOGRAM)
  @param summaryData - Summary statistics data (when type is SUMMARY)
  @param attributes - Metric attributes/labels for dimensional data
  @param timestamp - When the metric was recorded
  @param traceContext - Optional distributed trace correlation
  @param resource - Resource attributes identifying the metric source
  @param scope - Instrumentation scope information
  @param createdAt - When the metric was stored in the system
  @param updatedAt - When the metric was last updated
"""
type Statistic {
  id: String!
  name: String!
  description: String
  unit: String
  type: OTelMetricType!
  value: Float
  histogramData: HistogramData
  summaryData: SummaryData
  attributes: Any
  timestamp: Date
  traceContext: TraceContext
  resource: MetricResource
  scope: InstrumentationScope
  createdAt: Date!
  updatedAt: Date
}

"""
  Statistics - statistics package entry
  @param id - id of the statistic entry
  @param partner - partner / ReactoryClient of the statistic entry
  @param user - user of the statistic entry
  @param reference - reference of the statistic entry
  @param entries - array of statistic entries
"""
type StatisticsPackage {
  id: String!
  partner: ReactoryClient
  user: User
  reference: String!
  title: String
  description: String
  processed: Boolean
  processor: String
  statistics: [Statistic]
  createdAt: Date!
  updatedAt: Date
}

"""
  StatisticsReceipt - receipt of statistics
  @param reference - reference of the statistics
  @param success - success of the statistics
  @param message - message of the statistics
"""
type StatisticsReceipt {
  reference: String
  success: Boolean
  message: String
}

"""
  StatisticsFilter - Filter for retrieving statistics/metrics
  @param names - Metric names to filter by
  @param types - Metric types to filter by
  @param attributes - Attribute filters (key-value pairs)
  @param serviceName - Filter by service name
  @param from - From date/time
  @param till - Till date/time
  @param references - Package references (for backward compatibility)
"""
input StatisticsFilter {
  names: [String]
  types: [OTelMetricType]
  attributes: Any
  serviceName: String
  from: Date
  till: Date
  references: [String]
}

"""
  HistogramBucketInput - Input for histogram bucket
"""
input HistogramBucketInput {
  upperBound: Float!
  count: Int!
  exemplars: [Any]
}

"""
  HistogramDataInput - Input for histogram data
"""
input HistogramDataInput {
  count: Int!
  sum: Float!
  min: Float
  max: Float
  buckets: [HistogramBucketInput!]!
}

"""
  SummaryQuantileInput - Input for summary quantile
"""
input SummaryQuantileInput {
  quantile: Float!
  value: Float!
}

"""
  SummaryDataInput - Input for summary data
"""
input SummaryDataInput {
  count: Int!
  sum: Float!
  quantiles: [SummaryQuantileInput!]!
}

"""
  TraceContextInput - Input for trace context
"""
input TraceContextInput {
  traceId: String
  spanId: String
  traceFlags: Int
}

"""
  MetricResourceInput - Input for metric resource attributes
"""
input MetricResourceInput {
  serviceName: String
  serviceVersion: String
  serviceInstanceId: String
  deploymentEnvironment: String
  hostName: String
  attributes: Any
}

"""
  InstrumentationScopeInput - Input for instrumentation scope
"""
input InstrumentationScopeInput {
  name: String!
  version: String
  schemaUrl: String
}

"""
  StatisticsInput - Input for creating/updating OpenTelemetry-compatible metrics
  
  @param name - Metric name (required, use snake_case)
  @param description - Human-readable description
  @param unit - Unit of measurement (e.g., ms, bytes, requests)
  @param type - Metric type (counter, gauge, histogram, summary, updowncounter)
  @param value - Current value (for counter/gauge/updowncounter types)
  @param histogramData - Histogram distribution (when type is HISTOGRAM)
  @param summaryData - Summary statistics (when type is SUMMARY)
  @param attributes - Dimensional data as key-value pairs (labels/tags)
  @param timestamp - When the metric was recorded
  @param traceContext - Optional trace correlation information
  @param resource - Resource attributes identifying the source
  @param scope - Instrumentation scope information
  @param ttl - Time to live in seconds (optional, for automatic cleanup)
  
  Examples:
  
  Counter:
  {
    "name": "http_requests_total",
    "type": "COUNTER",
    "value": 42,
    "attributes": { "method": "GET", "status": "200" },
    "unit": "1"
  }
  
  Histogram:
  {
    "name": "http_request_duration_ms",
    "type": "HISTOGRAM",
    "histogramData": {
      "count": 100,
      "sum": 5000,
      "buckets": [
        { "upperBound": 10, "count": 20 },
        { "upperBound": 50, "count": 60 }
      ]
    },
    "attributes": { "endpoint": "/api/users" },
    "unit": "ms"
  }
"""
input StatisticsInput {
  name: String!
  description: String
  unit: String
  type: OTelMetricType!
  value: Float
  histogramData: HistogramDataInput
  summaryData: SummaryDataInput
  attributes: Any
  timestamp: Date
  traceContext: TraceContextInput
  resource: MetricResourceInput
  scope: InstrumentationScopeInput
  ttl: Int
}

"""
  StatisticUpdateInput - Input for updating an existing statistic
"""
input StatisticUpdateInput {
  id: ObjID!
  description: String
  value: Float
  histogramData: HistogramDataInput
  summaryData: SummaryDataInput
  attributes: Any
  ttl: Int
}

"""
Input for StatisticsPackageUpdate
"""
input StatisticsPackageUpdateInput {
  id: String!
  title: String
  description: String
  references: [String]
  processed: Boolean
  processor: String
}

extend type Query {
  """
    CoreGetStatistics - get statistics
    @param filter - filter for statistics
  """
  CoreGetStatistics(filter: StatisticsFilter): [Statistic]

  """
    CoreGetStatisticsPackage - get statistics package
    @param reference - reference of the statistics package
  """
  CoreGetStatisticsPackage(reference: String!): StatisticsPackage
  
    """
      CoreGetStatisticsPackages - get statistics packages
      @param filter - filter for statistics packages
    """
  CoreGetStatisticsPackages(filter: StatisticsFilter): [StatisticsPackage]
}

extend type Mutation {
  """
    CorePublishStatistics - publish statistics
    @param entries - array of statistics entries

    Returns a StatisticsReceipt.
  """
  CorePublishStatistics(entries: [StatisticsInput]!): StatisticsPackage

  """
    CoreProcessStatistics - process statistics
    @param reference - reference of the statistics
    @param processor - processor of the statistics - The processor is a string that is used to identify the processor.
    Usually this is a FQN and would follow the following naming convention: <nameSpace>.<name>@<version>
    e.g. core.ReactoryDefaultFormTelemetryProcessor@1.0.0
    @param params - parameters for the processor

    Returns a StatisticsPackage. This package contains the processed statistics.
  """
  CoreProcessStatistics(reference: String!, processor: String!, params: Any): StatisticsPackage


  """
    CoreUpdateStatistic - update statistic
    @param input - input for updating statistic
  """
  CoreUpdateStatistic(input: StatisticUpdateInput!): Statistic

  """
    CoreUpdateStatisticsPackage - update statistics package
    @param input - input for updating statistics package
  """
  CoreUpdateStatisticsPackage(input: StatisticsPackageUpdateInput!): StatisticsPackage
}